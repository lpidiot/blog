<!doctype html>
<html lang="zh">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>博客</title>
    <meta name="description" content=""/>
    <meta name="keywords" content=""/>
    <link rel="stylesheet" type="text/css" href="statics/css/index.css"/>
    <link rel="stylesheet" type="text/css" href="statics/css/detail.css"/>
    <link rel="stylesheet" type="text/css" href="statics/css/widgets.css"/>
    <link rel="stylesheet" type="text/css" href="statics/css/atelier-dune-dark.css"/>
    <style type="text/css">
        pre {
            position: relative;
            margin-bottom: 24px;
            border-radius: 3px;
            background: #f7f7f7;
            overflow: hidden;
        }

        code {
            display: block;
            padding: 12px 24px;
            overflow-y: auto;
            font-family: 'Roboto Mono', Monaco, courier, monospace;
            font-size: 13px;
            color: #4d4d4c;
        }

        code.has-numbering {
            margin-left: 21px;
        }

        .pre-numbering {
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            padding: 13px 12px 12px 12px;
            border-radius: 3px 0 0 3px;
            text-align: right;
            font-family: Menlo, monospace;
            font-size: 0.8em;
            color: #555;
        }

        .pre-numbering li {
            list-style-type: none;
            text-align: right;
        }

        .hidden{
            display: none;
        }

    </style>
</head>

<body class="home blog custom-background round-avatars" itemscope itemtype="http://schema.org/Organization">


<!--<div class="hebin" data-aos="fade-down">
    <i class=" js-toggle-search iconfont">&#xe60e;</i>
</div>-->

<div id="main" class="content">
    <div class="container">
        <article id="post-1202"
                 class="js-gallery post-1202 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized tag-11 tag-22 tag-29">
            <style>
                .container {
                    padding: 10px 0px;
                }

                .post {
                    margin: 0 auto
                }
            </style>
            <section class="post_content">
                <header class="post_header">
                    <h1 class="post_title" data-th-text="${article.title}">给大家介绍一下</h1>
                </header>
                <div id="content" class="js-gallery">
                    内容...
                </div>
                <div class="meta split split--responsive cf">
                    <div class="split__title">
                        <time data-th-text="${article.time}">2017/10/02</time>
                        <span class=""><a href="" rel="tag">主题</a></span>
                    </div>
                    <!--<div id="social-share"><span class="entypo-share"><i class="iconfont">&#xe614;</i>分享</span></div>-->
                    <div class="slide">
                        <a class="btn-slide" title="switch down"><i class="iconfont">&#xe615;</i>折叠评论区</a>
                    </div>
                </div>
            </section>
        </article>
    </div>
    <svg id="upTriangleColor" width="100%" height="40" viewBox="0 0 100 102" preserveAspectRatio="none">
        <path d="M0 0 L50 100 L100 0 Z"></path>
    </svg>
    <a class="scroll-top2 opacity" href="#comment_list">
        <span class="comment-icon"></span>
    </a>
    <!--分享区-->
    <!--  <div id="social">
          <ul>
              <li>
                  <a href="" title="qzone" target="_blank"><i class="iconfont">&#xe67f;</i></a>
              </li>
              <li>
                  <a href="" title="weibo" target="_blank"><i class="iconfont">&#xe680;</i></a>
              </li>
              <li>
                  <a href="" title="douban" target="_blank"><i class="iconfont">&#xe681;</i></a>
              </li>
              <li>
                  <a href="" title="twitter" target="_blank"><i class="iconfont">&#xe683;</i></a>
              </li>
          </ul>
      </div>-->
    <!--/分享区-->
    <div id="panel">
        <div class="comment-area">
            <section class="comments">
                <div class="comments-main">
                    <div id="comments-list-title"><span data-th-text="${article.access}">30</span> 条评论</div>
                    <div id="loading-comments">
                        <div class="host">
                            <div class="loading loading-0"></div>
                            <div class="loading loading-1"></div>
                            <div class="loading loading-2"></div>
                        </div>
                    </div>
                    <ul class="commentwrap" id="comment_list">
                        <!-- <li class="comment even thread-even depth-1" id="li-comment-">
                             <div id="comment-969" class="comment_body contents">
                                 <div class="profile">
                                     <a href=""><img src="statics/images/9cc50a9e422fb1c89aebafeb959cef7a.jpg"
                                                     class="gravatar"></a>
                                 </div>
                                 <div class="main shadow">
                                     <div class="commentinfo">
                                         <section class="commeta">
                                             <div class="shang">
                                                 <h4 class="author"><a href="" target="_blank"><img
                                                         src="statics/images/9cc50a9e422fb1c89aebafeb959cef7a.jpg"
                                                         class="gravatarsmall">小布丁</a></h4>
                                             </div>
                                         </section>
                                     </div>
                                     <div class="body">
                                         <p>挺好的</p>
                                     </div>
                                     <div class="xia info">
                                         <span><time datetime="2018-03-09">2018年3月9日</time></span>
                                         <span><a rel='nofollow' class='comment-reply-link' href=""
                                                  onclick='return addComment.moveForm( "comment-969", "969", "respond", "1202" )'
                                                  aria-label='回复给小布丁'>回复</a></span>
                                     </div>
                                 </div>
                             </div>
                         </li>-->
                        <!-- #comment-## -->
                    </ul>

                  <!--  <div id="respond" class="comment-respond">
                        <h6 id="replytitle" class="comment-reply-title"><a rel="nofollow" id="cancel-comment-reply-link"
                                                                           href="" style="display:none;">取消</a></h6>
                        &lt;!&ndash;<form action="" method="post" id="commentform" class="clearfix">&ndash;&gt;
                        <div class="clearfix"></div>
                        <div class="author-info">
                            <input type="text" name="articleId" id="articleId" data-th-value="${article.id}"
                                   style="display: none"/>
                            <input type="text" name="nickName" id="nickName" placeholder="昵  称 : " value="" tabindex="1"
                                   title="Name (required)"/>
                            <input type="text" name="email" id="email" placeholder="邮  箱 : " value="" tabindex="2"
                                   title="E-mail(will not be published) required"/>
                            <input type="text" name="userUrl" id="userUrl" placeholder="网  址 : " value="" tabindex="3"
                                   title="Website"/>
                        </div>
                        <div class="clearfix"></div>
                        <input type='hidden' name='comment_post_ID' value='1202' id='comment_post_ID'/>
                        <input type='hidden' name='comment_parent' id='comment_parent' value='0'/>
                        <p style="display: none;"><input type="hidden" id="akismet_comment_nonce"
                                                         name="akismet_comment_nonce" value="632104fca1"/></p>
                        <p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="87"/></p>
                        <div class="comment-form-info">
                            <div class="real-time-gravatar"><img id="real-time-gravatar"
                                                                 src="statics/images/d41d8cd98f00b204e9800998ecf8427e.png"
                                                                 alt="gravatar头像"/>
                            </div>
                            <p class="input-row">
                                <i class="row-icon"></i>
                                <textarea class="text_area" rows="3" cols="80" name="content" id="comment"
                                          tabindex="4" placeholder="你不说两句吗？(°∀°)ﾉ……"></textarea>
                                <button class="button submit" id="submit" tabindex="5"
                                        onclick="addComment()">发送
                                </button>
                            </p>
                        </div>
                        &lt;!&ndash; </form>&ndash;&gt;
                    </div>-->
                </div>
            </section>
        </div>
    </div>

</div>

<!--<div class="p-header">
    <figure class="p-image"
            style="background-image: url(statics/images/47fb3c_9afed6c259f94589881bd55376206366mv2_d_3840_5784_s_4_2.jpg);"></figure>
</div>-->

<div class="hidden navpost-part">
    <div id="NextPrevPosts">
        <div class="prev" data-aos="slide-right" data-aos-delay="1.5s"
             data-th-if="${prevArticle!=null&&prevArticle!=''}">
            <div class="arrow"><i class="iconfont">&#xe625;</i></div>
            <div class="preview">
                <img class="pull-left featuredImg"
                     src="statics/images/no-image.png"/>
                <a class="pull-left preview-content bold" data-th-href="${'detail?id='+prevArticle.id}"><span
                        data-th-text="${prevArticle.title}">《别哭妈妈》</span></a>
            </div>
        </div>
        <div class="next" data-aos="slide-left" data-aos-delay="1.5s"
             data-th-if="${nextArticle!=null&&nextArticle!=''}">
            <div class="arrow"><i class="iconfont">&#xe623;</i></div>
            <div class="preview">
                <img class="pull-right featuredImg" src="statics/images/no-image.png"/>
                <a class="pull-right preview-content bold" data-th-href="${'detail?id='+nextArticle.id}"><span
                        data-th-text="${nextArticle.title}">重构图像样式测试</span></a>
            </div>
        </div>
    </div>
</div>


<script type='text/javascript' src='statics/js/jquery.min.js'></script>
<script type='text/javascript' src='statics/js/plugins.js'></script>
<script type='text/javascript' src='statics/js/script.js'></script>
<script type='text/javascript' src='statics/js/particles.js'></script>
<script type='text/javascript' src='statics/js/aos.js'></script>
<script type='text/javascript' src='statics/js/prism.js'></script>
<script type='text/javascript' src='statics/js/gravatar.js'></script>
<script src="statics/marked-master/marked.min.js"></script>
<script type='text/javascript' src='statics/js/widgets.js'></script>
<script src="http://cdn.bootcss.com/highlight.js/8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.3.0/highlightjs-line-numbers.min.js"></script>
<script type="text/javascript" data-th-inline="javascript">
    window.onscroll = function () {
        var scrollTop = document.body.scrollTop;
        if (scrollTop >= 200) {
            document.getElementById("NextPrevPosts").style.display = "none"

        } else {
            document.getElementById("NextPrevPosts").style.display = "block"
        }
    };


    var rendererMD = new marked.Renderer();
    marked.setOptions({
        renderer: rendererMD,
        gfm: true,
        tables: true,
        breaks: false,
        pedantic: false,
        sanitize: false,
        smartLists: true,
        smartypants: false
    });

    marked.setOptions({
        highlight: function (code) {

            return hljs.highlightAuto(code).value;
        }
    });

    document.getElementById('content').innerHTML = marked([[${article.content}]]);

    //console.log([[${article.content}]]);
    //document.getElementById('content').innerHTML = marked([[${article.content}]]);
    //numbering for pre>code blocks
    $('pre code').each(function () {
        var lines = $(this).text().split('').length;

        var $numbering = $('<ul/>').addClass('pre-numbering');
        $(this)
            .addClass('has-numbering')
            .parent()
            .append($numbering);
        for (var i = 1; i <= lines; i++) {
            $numbering.append($('<li/>').text(i));
        }
    });


    function addComment() {
        var content = $('#comment').val();
        if (content == null || content == '') {
            alert('请先输入内容哦=');
            return;
        }
        $.ajax({
            url: 'addComment',
            cache: false,
            data: {
                articleId: $('#articleId').val(),
                nickName: $('#nickName').val(),
                email: $('#email').val(),
                userUrl: $('#userUrl').val(),
                content: content
            },
            success: function (result) {
                console.log(result);
            }
        })
    }

    $(function () {
        getComment();
    });


    function getComment(page) {
        if (typeof(page) == "undefined") {
            page = 0;
        }
        $.ajax({
            url: 'getComment',
            data: {
                articleId: [[${article.id}]],
                page: page,
                size:8
            },
            success: function (result) {
                if (result.comments.length > 0) {
                    var comments = result.comments;
                    var html = '';
                    for (var i in comments) {
                        html += '   <li class="comment even thread-even depth-1">' +
                            '                            <div class="comment_body contents">' +
                            '                                <div class="profile">' +
                            '                                    <a href=""><img src="statics/images/9cc50a9e422fb1c89aebafeb959cef7a.jpg"' +
                            '                                                    class="gravatar"></a>' +
                            '                                </div>' +
                            '                                <div class="main shadow">' +
                            '                                    <div class="commentinfo">' +
                            '                                        <section class="commeta">' +
                            '                                            <div class="shang">' +
                            '                                                <h4 class="author"><a href="" target="_blank"><img' +
                            '                                                        src="statics/images/9cc50a9e422fb1c89aebafeb959cef7a.jpg"' +
                            '                                                        class="gravatarsmall">' + comments[i].nickName + '</a></h4>' +
                            '                                            </div>' +
                            '                                        </section>' +
                            '                                    </div>' +
                            '                                    <div class="body">' +
                            '                                        <p>' + comments[i].content + '</p>' +
                            '                                    </div>' +
                            '                                    <div class="xia info">' +
                            '                                        <span><time datetime="2018-03-09">' + comments[i].time + '</time></span>' +
                            '                                        <span><a rel=\'nofollow\' class=\'comment-reply-link\' href=""' +
                            '                                                 onclick=\'return addComment.moveForm( "comment-969", "969", "respond", "1202" )\'' +
                            '                                                 aria-label=\'回复给小布丁\'>回复</a></span>' +
                            '                                    </div>' +
                            '                                </div>' +
                            '                            </div>' +
                            '                        </li>'
                    }
                }
                $('#comment_list').html(html);

                createPageDesc(result.pageInfo);
                return;
            }
        })
    }

    var currentComment = 1;

    function currentCommentChange() {
        currentComment++;
    }

    function createPageDesc(pageInfo) {
        var currentPage = pageInfo.currentPage;    //当前页
        var totalPages = pageInfo.totalPages;     //总页数
//console.log(totalPages);
        if (totalPages > 1) {
            var pagination = '<a class="prev page-numbers hand" onclick="getComment(' + i + ',change)">' + '<</a>';      //分页标签
            var flag = totalPages > 8 ? true : false;           //大于8页只显示8页，flag用来记录，后面通过flag判断是否大于8页(区分本来就只有8页)
            if (totalPages > 8) {
                totalPages = 8;
            }

            for (var i = 1; i <= totalPages; i++) {     //拼装
                if (i == currentPage) {                 //当前页加上样式区分
                    pagination += '<span aria-current="page" class="page-numbers current hand">' + i + '</span>';
                } else {
                    pagination += '<a class="page-numbers hand" onclick="getComment(' + i + ')">' + i + '</a>';
                }
            }
            if (flag) {
                pagination += '<a class="page-numbers hand" href="#">...</a>';    //大于8页，显示省略号==
            }
        }
        $('#comments-navi').html(pagination);
        return;
    }



    function androidAddComment(content) {
        $.ajax({
            url: 'addComment',
            cache: false,
            data: {
                articleId: [[${article.id}]],
                nickName: "kerisu",
                content: content
            },
            success: function (result) {
                console.log(result);
                $('#comment').val('');
                getComment();
            }
        })
    }
</script>
</body>
</html>